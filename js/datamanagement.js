function portExistingData(){if(!localStorage.privatedata){var a={};a.name=localStorage.name,a.annualgoal=localStorage.annualgoal,localStorage.dailygoal?a.dailygoal=localStorage.dailygoal:a.dailygoal="",localStorage.scratchpad?a.scratchpad=localStorage.scratchpad:a.scratchpad="",localStorage.privatedata=JSON.stringify(a)}if(!localStorage.metadata){var t={};t.guid="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var t=16*Math.random()|0;return("x"==a?t:3&t|8).toString(16)}),localStorage.dailygoalset?t.dailygoalset=localStorage.dailygoalset:t.dailygoalset="",localStorage.weather?t.weather=localStorage.weather:t.weather="",localStorage.woeid?t.woeid=localStorage.woeid:t.woeid="",localStorage.country?t.country=localStorage.country:t.country="",localStorage.city?t.city=localStorage.city:t.city="",localStorage.wakeuptime?t.wakeuptime=localStorage.wakeuptime:t.wakeuptime={},localStorage.metadata=JSON.stringify(t)}}function dataSetup(){if(localStorage.storageType="local",localStorage.initv2||(localStorage.timeanalytics=JSON.stringify({}),localStorage.productivity=JSON.stringify({}),localStorage.site=JSON.stringify({}),localStorage.initv2=1),!localStorage.metadata&&localStorage.name&&portExistingData(),localStorage.privatedata||(localStorage.privatedata=JSON.stringify({})),!localStorage.metadata){var a={};a.guid=guid(),a.suid=guid(),a.wakeuptime={},localStorage.metadata=JSON.stringify(a)}localStorage.donttrack||(localStorage.donttrack=JSON.stringify({})),localStorage.timeanalytics||(localStorage.timeanalytics=JSON.stringify({})),localStorage.productivity||(localStorage.productivity=JSON.stringify({})),localStorage.triggerStorage||(localStorage.triggerStorage=JSON.stringify({}))}function isFirstInstall(){if(!localStorage.settings)return a={},a.firstuse=1,localStorage.settings=JSON.stringify(a),!0;var a=JSON.parse(localStorage.settings);return a.length<1&&(a={},a.firstuse=1,a.init=1,a.initv2=1,localStorage.settings=JSON.stringify(a),!1)}function getAnnualGoal(){var a=JSON.parse(localStorage.privatedata);return a.annualgoal?a.annualgoal:setAnnualGoal("")}function setAnnualGoal(a){var t=JSON.parse(localStorage.privatedata);return""==a&&(a="Be an awesome human."),t.annualgoal=a,localStorage.privatedata=JSON.stringify(t),a}function getDailyGoal(){var a=JSON.parse(localStorage.privatedata);return a.dailygoal?a.dailygoal:setDailyGoal("")}function setDailyGoal(a){var t=JSON.parse(localStorage.privatedata);return t.dailygoal=a,localStorage.privatedata=JSON.stringify(t),a}function getScratchpad(){var a=JSON.parse(localStorage.privatedata);return a.scratchpad?a.scratchpad:setDailyGoal("")}function setScratchpad(a){var t=JSON.parse(localStorage.privatedata),e=JSON.parse(localStorage.metadata);t.scratchpad||(t.scratchpad=""),t.scratchpad=a,localStorage.privatedata=JSON.stringify(t),e.scratchpaduse||(e.scratchpaduse=0),e.scratchpaduse++,localStorage.metadata=JSON.stringify(e)}function addCalendarEvent(a,t){var e=JSON.parse(localStorage.privatedata);e.calendar||(e.calendar={}),e.calendar[a]=t,localStorage.privatedata=JSON.stringify(e)}function addTodo(a){var t=JSON.parse(localStorage.privatedata);t.todo||(t.todo=[]),t.todo.push(a),localStorage.privatedata=JSON.stringify(t)}function getRandomTodo(){var a=JSON.parse(localStorage.privatedata);if(!a.todo||a.todo.length<1)return"";var t=Math.floor(Math.random()*a.todo.length);return a.todo[t]}function getNextTodo(){var a=JSON.parse(localStorage.privatedata);return!a.todo||a.todo.length<1?"":a.todo[0].substring(0,20)+"..."}function getNextEventTime(a){var t=JSON.parse(localStorage.privatedata);if(!t.calendar||t.calendar.arraylength<1)return"";var e=-1;for(var r in t.calendar)r<=a?delete t.calendar[r]:(r<e||-1==e)&&(e=r);return localStorage.privatedata=JSON.stringify(t),-1!=e?e:void 0}function getNextEventName(a){var t=JSON.parse(localStorage.privatedata),e=getNextEventTime(a);return parseInt(e)>0?t.calendar[e]:""}function getNextEvent(a){var t=getNextEventTime(a);return parseInt(t)>0?getNextEventName(a).substring(0,15)+": "+timeBetween(a,t):""}function isThereAnEvent(){var a=JSON.parse(localStorage.privatedata);return!(!a.calendar||a.calendar.arraylength<1)}function isImpendingEvent(a){var t=JSON.parse(localStorage.privatedata);if(!t.calendar||t.calendar.arraylength<1)return!1;var e=-1;for(var r in t.calendar)r<=a?delete t.calendar[r]:(r<e||-1==e)&&(e=r);return-1!=e&&e>a&&e-a<3600}function clearCalendarandTodo(){var a=JSON.parse(localStorage.privatedata);a.todo=[],a.calendar={},localStorage.privatedata=JSON.stringify(a)}function getDontTrackArr(){return JSON.parse(localStorage.donttrack)}function isDontTrack(a){return!!JSON.parse(localStorage.donttrack)[a]}function addDonttrack(a){var t=JSON.parse(localStorage.donttrack);t[a]=1,localStorage.donttrack=JSON.stringify(t)}function removeDonttrack(a){var t=JSON.parse(localStorage.donttrack);t[a]&&delete t[a],localStorage.donttrack=JSON.stringify(t)}function addWildcard(a,t,e,r){var o=JSON.parse(localStorage.privatedata);o.wildcard||(o.wildcard={}),o.wildcard[a]||(o.wildcard[a]={}),o.wildcard[a].category=e,o.wildcard[a].productivity=t,o.wildcard[a].track=r,localStorage.privatedata=JSON.stringify(o);var i=JSON.parse(localStorage.timeanalytics);for(var l in i)-1!=l.indexOf(a)&&(i[l].productive=t,i[l].category=e);localStorage.timeanalytics=JSON.stringify(i),r&&addDonttrack(a,r)}function getWildcard(a){var t=JSON.parse(localStorage.privatedata);return!(!t.wildcard||!t.wildcard[a])&&t.wildcard[a]}function getTimeSpentDayFormatted(a,t){var e=JSON.parse(localStorage.timeanalytics);return e[a]&&e[a][t]&&!isNaN(e[a][t])?formatTime(e[a][t]).split(" "):""}function getProductive(a){var t=JSON.parse(localStorage.timeanalytics);return t[a]?t[a].productive:null}function getCategory(a){var t=JSON.parse(localStorage.timeanalytics);return t[a]?t[a].category:null}function shouldQueryServer(a){var t=JSON.parse(localStorage.timeanalytics);if(!t[a]||!t[a].category||"Other"==t[a].category.trim()&&Math.random()<.1)return!0}function getLastMetadataBackup(){var a=JSON.parse(localStorage.metadata);return a.backuptime||(a.backuptime=0),a.backuptime}function setLastMetadataBackup(a){var t=JSON.parse(localStorage.metadata);t.backuptime=a,localStorage.metadata=JSON.stringify(t)}function backupDatainServer(){var a=JSON.parse(localStorage.metadata);if(!a.version||null==a.version){var t=chrome.runtime.getManifest();a.version=t.version,localStorage.metadata=JSON.stringify(a)}a.listenloopid&&null!=a.listenloopid||(a.listenloopid=localStorage["fk-user-65-visitor-id"],localStorage.metadata=JSON.stringify(a)),$.post(BACKUPURL,{guid:a.guid,op:"metadata",data:localStorage.metadata,timedata:{}},function(a,t){}),time=new Date,setLastMetadataBackup(Math.round(time.getTime()/1e3))}function setLocation(a,t,e,r,o){var i=JSON.parse(localStorage.metadata);i.city=a,i.country=t,i.woeid=e,i.lat=r,i.long=o,localStorage.metadata=JSON.stringify(i)}function setWeather(a,t){var e=JSON.parse(localStorage.metadata);e.weather=t,e.temp=a,localStorage.metadata=JSON.stringify(e)}function getWeatherInfo(){var a=JSON.parse(localStorage.metadata);return parseInt(a.temp)?("United States"==a.country?(temp=Math.floor(9*a.temp/5)+32,temp+="F"):temp=a.temp+"C",temp+" "+a.weather):""}function getTemperature(){return JSON.parse(localStorage.metadata).temp}function getCountry(){return JSON.parse(localStorage.metadata).country}function getCity(){return JSON.parse(localStorage.metadata).city}function getWoeid(){return JSON.parse(localStorage.metadata).woeid}function isLocationChanged(a,t){var e=JSON.parse(localStorage.metadata);return!e.lat||e.lat!=a||!e.long||e.long!=t}function isGoalSetToday(){var a=JSON.parse(localStorage.metadata),t=dateString;return dateString||(today=new Date,t=today.toDateString()),a.dailygoalset==t}function setGoalSetToday(){var a=JSON.parse(localStorage.metadata);a.dailygoalset=dateString,localStorage.metadata=JSON.stringify(a)}function getAwakeTime(a){var t=JSON.parse(localStorage.metadata);if(!t.wakeuptime||!t.wakeuptime[a]){setWakeupTime();return(new Date).getHours()}return t.wakeuptime[a].up}function setWakeupTime(){var a=JSON.parse(localStorage.metadata);now=new Date;var t=now.toDateString(),e=now.getHours();a.wakeuptime||(a.wakeuptime={}),a.wakeuptime[t]?a.wakeuptime[t].last=e:(a.wakeuptime[t]={},a.wakeuptime[t].up=e,a.wakeuptime[t].last=e),localStorage.metadata=JSON.stringify(a)}function getBrowsingPercent(a,t){var e=JSON.parse(localStorage.metadata);return hour>e.wakeuptime[t].up?browserpercent=Math.floor(100*a/(3600*(hour-e.wakeuptime[t].up))):100}function getGuid(){return JSON.parse(localStorage.metadata).guid}function isTopSitesPermissionExist(){return!!JSON.parse(localStorage.settings).topSites}function setTopSitesPermission(){var a=JSON.parse(localStorage.settings);a.topSites=1,localStorage.settings=JSON.stringify(a)}function isFirst(){if(JSON.parse(localStorage.settings).init)return!1;var a=chrome.runtime.getManifest().version;return _gaq.push(["_trackEvent","Status","Install",a]),!0}function doneFirst(){var a=JSON.parse(localStorage.settings);a.init=1,localStorage.settings=JSON.stringify(a);var t={};t[1]="Happy New Year",t[359]="Merry Christmas",localStorage.festivals=JSON.stringify(t)}function getTopSitesShow(){var a=JSON.parse(localStorage.settings);return 0!=a.topSitesHide&&1!=a.topSitesHide&&(a.topSitesHide=0,localStorage.settings=JSON.stringify(a)),a.topSitesHide}function setShowTopSites(){var a=JSON.parse(localStorage.settings);a.topSitesHide=0,localStorage.settings=JSON.stringify(a)}function setHideTopSites(){var a=JSON.parse(localStorage.settings);a.topSitesHide=1,localStorage.settings=JSON.stringify(a)}function getTopSitesData(){for(var a=(new Date,{}),t=new Array("google.com","en.wikipedia.org","quora.com","lumosity.com","coursera.org","mail.google.com","lifehacker.com","ted.com","todayifoundout.com/"),e=0;e<t.length;)o=t[e++],a[o]||(a[o]=0);var r=0;if(timeanalytics){for(var o in timeanalytics){var i=parseInt(timeanalytics[o][dateString]);isNaN(i)&&(i=0),i>500&&"newtab"!==o?(a[o]=i,r++):null!=a[o]&&(a[o]=i)}if(r<10)for(var o in timeanalytics){var i=0;for(var l in timeanalytics[o])isNaN(timeanalytics[o][l])||(i+=parseInt(timeanalytics[o][l]));i>5e3&&"newtab"!==o&&!a[o]&&(a[o]=parseInt(timeanalytics[o][dateString]),isNaN(a[o])&&(a[o]=0),r++)}}var n=[];for(var o in a)isNaN(a[o])&&(a[o]=0),n.push([o,a[o]]);return n.sort(function(a,t){return a=a[1],t=t[1],a>t?-1:a<t?1:0}),new Date,n}function setupData(){totalTimeAll=0,productive=0,totalTime=[],sortedSites=[];var a=JSON.parse(localStorage.donttrack);timeanalytics=JSON.parse(localStorage.timeanalytics);for(var t in timeanalytics){var e=0;if(!a[t]&&"newtab"!=t){""==timeanalytics[t].category&&(timeanalytics[t].category="Other",localStorage.timeanalytics=JSON.stringify(timeanalytics)),timeanalytics[t]&&timeanalytics[t].category&&timeanalytics[t].category.length>30&&(timeanalytics[t].category="Other",localStorage.timeanalytics=JSON.stringify(timeanalytics));var r=timeanalytics[t].category.split(",");if(timeanalytics[t][dateString]&&"today"==localStorage.dateoption)timeanalytics[t][dateString]=parseInt(timeanalytics[t][dateString]);else if("today"==localStorage.dateoption)continue;if(1==parseInt(timeanalytics[t].productive)&&timeanalytics[t][dateString]&&(productive+=parseInt(timeanalytics[t][dateString])),"all"==localStorage.dateoption)for(var o in timeanalytics[t])isNaN(timeanalytics[t][o])||(e+=parseInt(timeanalytics[t][o]));else timeanalytics[t][dateString]&&(e=parseInt(timeanalytics[t][dateString]));totalTimeAll+=e;for(var i=0;i<r.length;i++){var l=r[i].trim();totalTime[l]?totalTime[l]+=e:totalTime[l]=e}}}for(var l in totalTime)sortedSites.push([l,totalTime[l]]);localStorage.triggerStorage||(localStorage.triggerStorage=JSON.stringify({})),localStorage.settings||(localStorage.settings=JSON.stringify({})),localStorage.privatedata||(localStorage.privatedata=JSON.stringify({})),sortedSites.sort(function(a,t){return a=a[1],t=t[1],a>t?-1:a<t?1:0})}var BACKUPURL="https://nice-fx-116906.appspot.com/backup";ProfileSaver={url:"https://nice-fx-116906.appspot.com/getemail",saveData:function(a){var t=a.name,e=a.email,r=a.goal,o=ProfileSaver.url+"?name="+t+"&email="+e+"&goal="+r;$.get(o)}},LLPrivateStorage={set:function(a){var t=JSON.parse(localStorage.privatedata);t=$.extend(t,a),localStorage.privatedata=JSON.stringify(t),ProfileSaver.saveData(a)},get:function(a){return data=JSON.parse(localStorage.privatedata),data[a]}};